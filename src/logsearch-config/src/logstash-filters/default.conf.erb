# NOTE: All parsed data should include @message, @level and @source.component.
# Otherwise these fields are set from syslog_ fields in teardown script afterwards.

# NOTE: @timestamp for CF components logs is set in logsearch-boshrelease from syslog_timestamp (timestamp set by metron_agent).
# Timestamp set by metron_agent for Firehose logs is <message JSON>.timestamp field. (That's why app.conf snippet sets date with it).

# Setup snippet (should precede all other snippets)
<%= File.read('src/logstash-filters/snippets/setup.conf') %>

##-- App
# (App snippet should precede all other app snippets)
<%= File.read('src/logstash-filters/snippets/app.conf') %>
# special cases parsing
<%= File.read('src/logstash-filters/snippets/app-logmessage.conf') %>
<%= File.read('src/logstash-filters/snippets/app-json.conf') %>
<%= File.read('src/logstash-filters/snippets/app-logmessage-app.conf') %>
<%= File.read('src/logstash-filters/snippets/app-logmessage-rtr.conf') %>
<%= File.read('src/logstash-filters/snippets/app-error.conf') %>
<%= File.read('src/logstash-filters/snippets/app-containermetric.conf') %>
<%= File.read('src/logstash-filters/snippets/app-valuemetric.conf') %>
<%= File.read('src/logstash-filters/snippets/app-counterevent.conf') %>
<%= File.read('src/logstash-filters/snippets/app-http.conf') %>
<%= File.read('src/logstash-filters/snippets/app-dedicated_cf_orgs.conf') %>

##-- Platform
# (Platform snippet should precede all other platform snippets)
<%= File.read('src/logstash-filters/snippets/platform.conf') %>
# special cases parsing
<%= File.read('src/logstash-filters/snippets/platform-haproxy.conf') %>
<%= File.read('src/logstash-filters/snippets/platform-uaa.conf') %>
<%= File.read('src/logstash-filters/snippets/platform-vcap.conf') %>

# Teardown snippet (should follow all other snippets)
<%= File.read('src/logstash-filters/snippets/teardown.conf') %>
